<!DOCTYPE html>
<html lang="en" th:object="${room}" xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <title th:text="*{roomNumber}" >-1</title>
    <style>
        .tag-list {
            list-style: none;
            padding: 0;
            display: flex;
        }

        .tag {
            margin-right: 10px;
        }
    </style>
</head>
<body>

<script>
    function renameParent(parent) {
        if(parent.value.includes('-X'))
            parent.value = parent.value.replace('-X', '')
        else
            parent.value = parent.value + '-X'
    }

</script>
  <h1>Details zu Raum <span th:text="*{roomNumber}">-1</span> </h1>

  <div th:if="${formValidationErrorText}">
    <div th:text="${formValidationErrorText}">ErrorText</div>
  </div>

<ul class="tag-list">
    <li th:each="tag : ${itemNames}" class="tag">
        <div sec:authorize="hasRole('ADMIN')">
            <form th:action="@{/items/delete}" method="post">
                <input type="hidden" name="tagName" th:value="${tag}" />
                <span th:text="${tag}"></span>
                <button type="submit">X</button>
            </form>
        </div>
    </li>
</ul>

<div sec:authorize="hasRole('ADMIN')">
    <form th:action="@{'/rooms' + ${getRoomID} + '/createItem/' + ${itemName}}" method="post">
        <labe for="createItem">Neuen Gegenstand hinzufügen:</labe>
        <input id="createItem" type="text">
        <input type="submit">
    </form>
</div>

<div sec:authorize="hasRole('ADMIN')">
    <form th:action="@{'/rooms' + ${getRoomID} + '/addItem/' + ${itemName}}" method="post">
        <div class="form-group">
            <label for="gegenstaende">Gegenstände im Raum</label>
            <select multiple id="gegenstaende" name="gegenstaende" class="form-control" required onchange="this.form.submit()">
                <option th:each="item : ${items}" th:value="${item.type}" th:text="${item.type}" th:selected="${gegenstaende != null and gegenstaende.contains(item.type)}"></option>
            </select>
        </div>
        <input type="submit" style="display: none;">
    </form>
</div>


  <form method="post" th:action="@{/rooms}">
      <input type="hidden" name="roomID" th:value="*{roomID}">
      <input type="hidden" name="stepSize" th:value="${frame.stepSize()}">

    <table class="table">
      <thead class="table-header">

        <tr>
            <th>Uhrzeit</th>
            <th>Datum</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
          <tr>
              <td></td>
              <td th:each="day: ${#numbers.sequence(0, frame.days()-1,1)}" th:remove="all-but-first">
                  <span th:text="${frame.dayLabels()[day]}">Monday Tuesday...</span>
              </td>
          </tr>

          <tr th:each="time: ${#numbers.sequence(0, (((frame.times())* 60) / frame.stepSize()) - 1,1)}">
              <td> <span th:text="${frame.timeLabels()[time]}">19:00</span> </td>
              <td th:each="day: ${#numbers.sequence(0, frame.days()-1,1)}">

                  <div>
                      <input  type="hidden" name="cell" th:value="${time + '-' + day}">
                      <input th:unless="${frame.reserved.get(day).get(time)}" type="checkbox" name="box" onchange="renameParent(this.parentElement.children[0])">
                      <input th:if="${frame.reserved.get(day).get(time)}" type="checkbox" name="box" onchange="renameParent(this.parentElement.children[0] )" checked>

                  </div>
              </td>
          </tr>
      </tbody>
    </table>

    <input type="submit">
  </form>
</body>
</html>